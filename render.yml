# render.yaml
# Blueprint for Comatozze static gallery site on Render.com
# Frontend-only deployment (backend is Cloudflare Worker)

services:
  - type: web
    name: comatozze
    env: static               # Static site hosting
    plan: free                # Free tier
    branch: main              # Deploy from main branch
    buildCommand: ""          # No build step needed
    staticPublishPath: .      # Serve from repo root
    autoDeploy: true          # Deploy on git pushes

    # Custom domain (optional - uncomment if using custom domain)
    # domains:
    #   - yourdomain.com

    # Security headers
    headers:
      - path: /*
        name: X-Frame-Options
        value: DENY
      - path: /*
        name: X-Content-Type-Options
        value: nosniff
      - path: /*
        name: Referrer-Policy
        value: strict-origin-when-cross-origin
      - path: /*
        name: Permissions-Policy
        value: geolocation=(), microphone=(), camera=()

    # Redirects for SPA routing (if needed)
    # This handles client-side routing for admin page
    routes:
      - type: redirect
        source: /admin
        destination: /admin.html
      - type: rewrite
        source: /*
        destination: /index.html

    # Health check (optional)
    healthCheckPath: /

    # Preview deployments for pull requests
    previews:
      generation: automatic

# Optional: Separate service for admin panel (if desired)
# services:
#   - type: web
#     name: comatozze-admin
#     env: static
#     plan: free
#     branch: main
#     buildCommand: ""
#     staticPublishPath: .
#     autoDeploy: true
#     rootDir: ./admin
#     envVars:
#       - key: API_BASE
#         sync: false
